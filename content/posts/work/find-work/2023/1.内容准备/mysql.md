---
title: "mysql"
subtitle: ""
description: ""
date: 2023-05-20T13:05:00+08:00
draft: true
authors: [索隆不喝酒]

tags: []
series: [card]
categories: [灵感、文献笔记（非永久笔记）]
series_weight: 1
seriesNavigation: true
featuredImage: ""
featuredImagePreview: ""
---
<!--more-->

## explain

解释具体的查找计划，可能包括：
> 1. 使用的`索`引
> 2. 表`连`接的方式
> 3. `定`位数据的方式
> 4. order 排序等等

**索连定**

引出子问题
- 索引是什么？有什么索引？
- 表连接的方式？为什么有时候效率低？
  
  使用外键效率会高点
  
- 定位数据有哪些方式？ 
  - 全表：为什么全表搜索会比较慢？什么时候会全表搜索会比索引快？
    在比较多的数据中查询比较少的数据的时候，如果全表扫描时间很长；
    
    全表扫描比索引快的例子：

    假设有一个名为"Orders"的表，包含了所有订单的信息，其中有一个列为"OrderDate"，记录订单的日期。现在需要查询某一天的所有订单数据。

    如果"OrderDate"列上没有索引或索引的选择性很低（即在该列上的不同值很少），数据库系统可能会认为使用索引不如执行全表扫描来得更有效。这是因为使用索引需要进行多次的索引查找操作，而对于大部分数据都是需要返回的情况下，遍历整个表可能更快。

    举个具体例子，假设有100万条订单数据，其中某一天的订单数量约占整个表的80%。如果使用索引，需要通过索引定位到该天的订单行，然后再逐行返回数据。而如果执行全表扫描，只需要遍历整个表一次，将满足条件的订单数据返回。

    在这种情况下，全表扫描可能比使用索引更高效，因为使用索引需要进行多次的索引查找操作，而遍历整个表的成本相对较低。这是一个典型的全表扫描更优的例子。但需要注意，这个情况并不适用于所有的查询场景，每个具体的情况都需要综合考虑表的大小、数据分布、索引选择性以及查询的特点来确定最佳的执行方式。
  - 范围
  - 索引

## possible key 是什么

explain 结果中，用来展示：查询可能用到了什么索引（这个结果是推断的，并不一定准确）

- 如何根据这个结果来做优化？
- 怎么判断一个查询是否充分利用了索引？
- 什么情况只需要访问索引，不需要回表读写？(覆盖索引)

    查找的列在索引中都能找到，就不需要回表。
    因此在设计的时候，可以的话，考虑把常用的查询列包含在索引中，增加覆盖索引的可能

- 如何优化一个索引，提高查询性能？

    思考模式：粒度从大到小，索引有什么操作？
    大粒度：选择合适的索引结构
    小粒度：
    - 在每个索引的角度来考虑，如果是复合索引，可以把常用的列，放到前面
    - 索引的尺寸：尽量小的数据类型，减少占用空间，能存的更多

    增删改查等操作：从修改的角度上看，应该尽量减少修改数据导致的索引更新（经常发生修改的列不适合作为索引）

## B+ 树

一些特点：多路查找树，有序的（每个节点上可范围查找），平衡的

## 查询慢的原因可能有什么？

- 索引
- 数据库设计，冗余
- 连接，不必要的查询
- 锁竞争

## 数据库中经常讨论的锁？

- 共享锁：可同时读
- 排他锁：写锁
- 行锁
- 表锁
- 乐观锁


- 具体解释一下上面的乐观锁，原理是什么，有什么好处和坏处

    何谓乐观：假设没有锁竞争

    乐观锁在事务提交的时候检查数据是否被修改，如果没有被修改，成功写入，如果被修改了，则取消事务的更改

- 有乐观锁，就有悲观锁，什么是悲观锁？

> 思考维度：性功安 扩维本

